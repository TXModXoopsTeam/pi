angular.module("userPluginModule").config(["$routeProvider","piProvider","config",function(a,b,c){function d(a){return c.assetRoot+a+".html"}a.when("/activity",{templateUrl:d("plugin-activity"),controller:"SortableCtrl"}).when("/quicklink",{templateUrl:d("plugin-quicklink"),controller:"SortableCtrl"}).otherwise({redirectTo:"/timeline",templateUrl:d("plugin-timeline"),controller:"TimelineCtrl"}),b.hashPrefix(),b.navTabs(c.navTabs),b.translations(c.t),b.ajaxSetup()}]).service("server",["$http","config",function(a,b){var c=b.urlRoot;this.timeline={get:function(b){return a.get(c+"timeline",{params:{p:b||1}})},put:function(b){return a.post(c+"toggleTimelineDisplay",{id:b.id})}},this.quicklink={get:function(){return a.get(c+"quicklink")},put:function(b){return a.post(c+"dressUpQuicklink",{ids:b})}},this.activity={get:function(){return a.get(c+"activity")},put:function(b){return a.post(c+"dressUpActivity",{ids:b})}}}]).controller("TimelineCtrl",["$scope","server",function(a,b){a.paginator={page:1},a.$watch("paginator.page",function(c){b.timeline.get(c).success(function(b){a.timeline=b.timeline,a.paginator=b.paginator})}),a.disableAction=function(a){a.active&&b.timeline.put(a).success(function(b){b.status&&(a.active=0)})},a.activeAction=function(a){a.active||b.timeline.put(a).success(function(b){b.status&&(a.active=1)})}}]).controller("SortableCtrl",["$scope","$location","server",function(a,b,c){function d(){var b=[],c=a.displayList;return angular.forEach(c,function(a){b.push(a.id)}),b=b.join(",")}var e=b.path().replace(/^\//,"");c[e].get().success(function(b){a.displayList=b.display_list,a.selectList=b.select_list}),a.removeDisplay=function(b){var f=a.displayList[b];a.displayList.splice(b,1),a.selectList.push(f),c[e].put(d())},a.addDisplay=function(b){var f=a.selectList[b];a.selectList.splice(b,1),a.displayList.push(f),c[e].put(d())},$("#js-plugin-sortable").sortable({start:function(a,b){b.item.data("start",b.item.index()),b.helper.outerWidth(b.item.outerWidth())},update:function(b,f){var g=f.item.data("start"),h=f.item.index(),i=a.displayList;i.splice(h,0,i.splice(g,1)[0]),a.$apply(),c[e].put(d())}})}]);